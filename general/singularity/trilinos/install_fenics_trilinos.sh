#!/bin/bash
SRCDIR=${TRILINOS_SRC}
ARCHDIR="/usr/local/trilinos/12.18.1"
FLAGS="-O3 -fPIC"
cmake \
-G "Unix Makefiles" \
-DCMAKE_C_COMPILER="$CC" \
-DCMAKE_CXX_COMPILER="$CXX" \
-DCMAKE_Fortran_COMPILER="$F77" \
-DCMAKE_CXX_FLAGS="-fPIC -g" \
-DCMAKE_C_FLAGS="$FLAGS" \
-DCMAKE_Fortran_FLAGS="$FLAGS" \
-DCMAKE_INSTALL_PREFIX="$ARCHDIR" \
-DCMAKE_MAKE_PROGRAM="make" \
-DTrilinos_ENABLE_OpenMP=OFF \
-DTrilinos_ENABLE_FLOAT=ON \
-DTrilinos_ENABLE_COMPLEX=ON \
-DTrilinos_ENABLE_CXX11=ON \
-DTPL_ENABLE_Pthread=ON \
-DTPL_Pthread_LIBRARIES="/usr/lib/x86_64-linux-gnu/libpthread.so" \
-DTPL_Pthread_INCLUDE_DIRS="/usr/include" \
-DTPL_DLlib_ENABLE=ON \
-DTPL_DLlib_LIBRARIES="/usr/lib/x86_64-linux-gnu/libdl.so" \
-DTPL_ENABLE_AMD=ON \
-DAMD_LIBRARY_DIRS="${SUITESPARSE_ROOT}/lib" \
-DTPL_AMD_INCLUDE_DIRS="${SUITESPARSE_ROOT}/include" \
-DTPL_ENABLE_UMFPACK=ON \
-DUMFPACK_LIBRARY_DIRS="${SUITESPARSE_ROOT}/lib" \
-DTPL_UMFPACK_INCLUDE_DIRS="${SUITESPARSE_ROOT}/include" \
-DTPL_ENABLE_MKL=ON \
-DMKL_LIBRARY_DIRS="${MKLROOT}/lib/intel64_lin" \
-DTPL_MKL_INCLUDE_DIRS="${MKLROOT}/include" \
-DTPL_ENABLE_TBB=OFF \
-DTPL_ENABLE_BLAS=ON \
-DTPL_BLAS_LIBRARIES="${MKLROOT}/lib/intel64/libmkl_rt.so" \
-DTPL_ENABLE_LAPACK=ON \
-DTPL_LAPACK_LIBRARIES="${MKLROOT}/lib/intel64/libmkl_rt.so" \
-DTPL_ENABLE_ParMETIS=ON \
-DParMETIS_INCLUDE_DIRS="${PARMETIS_ROOT}/include" \
-DTPL_ParMETIS_LIBRARIES="${PARMETIS_ROOT}/lib/libparmetis.so" \
-DTPL_ENABLE_MPI=ON \
-DMPI_BASE_DIR="$MPI_ROOT" \
-DTPL_ENABLE_CUDA=OFF \
-DTPL_ENABLE_Zlib=ON \
-DZlib_LIBRARY_DIRS="/usr/lib/x86_64-linux-gnu" \
-DTPL_Zlib_INCLUDE_DIRS="/usr/include" \
-DTPL_ENABLE_Boost=ON \
-DTPL_Boost_INCLUDE_DIRS="${LIBBOOST_ROOT}/include" \
-DBoost_LIBRARY_DIRS="${LIBBOOST_ROOT}/lib" \
-DTPL_ENABLE_BoostLib=ON \
-DTPL_BoostLib_INCLUDE_DIRS="${LIBBOOST_ROOT}/include" \
-DBoostLib_LIBRARY_DIRS="${LIBBOOST_ROOT}/lib" \
-DTPL_ENABLE_HDF5=ON \
-DTPL_HDF5_INCLUDE_DIRS="${LIBHDF5_ROOT}/include" \
-DHDF5_LIBRARY_DIRS="${LIBHDF5_ROOT}/lib" \
-DTPL_ENABLE_Netcdf=ON \
-DNetcdf_LIBRARY_DIRS="${NETCDF_ROOT}/lib" \
-DTPL_Netcdf_INCLUDE_DIRS="${NETCDF_ROOT}/include/" \
-DTPL_ENABLE_Pnetcdf=ON \
-DPnetcdf_LIBRARY_DIRS="${LIBPNETCDF_ROOT}/lib" \
-DTPL_Pnetcdf_INCLUDE_DIRS="${LIBPNETCDF_ROOT}/include" \
-DTPL_ENABLE_yaml-cpp=OFF \
-DTPL_ENABLE_GLPK=ON \
-DGLPK_INCLUDE_DIRS="${GLPK_ROOT}/include" \
-DGLPK_LIBRARY_DIRS="${GLPK_ROOT}/lib" \
-DTPL_ENABLE_Matio=OFF \
-DTPL_ENABLE_Scotch=OFF \
-DTPL_ENABLE_PETSC=ON \
-DPETSC_INCLUDE_DIRS="${PETSC_ROOT}/include" \
-DPETSC_LIBRARY_DIRS="${PETSC_ROOT}/lib" \
-DBUILD_SHARED_LIBS=ON \
-DTrilinos_ENABLE_ALL_PACKAGES=OFF \
-DTrilinos_ENABLE_ALL_OPTIONAL_PACKAGES=OFF \
-DTrilinos_ENABLE_ALL_FORWARD_DEP_PACKAGES=OFF \
-DTrilinos_ENABLE_OpenMP=ON \
-DTrilinos_ENABLE_Amesos2=ON \
-DAmesos2_ENABLE_UMFPACK=ON \
-DTrilinos_ENABLE_Belos=ON \
-DBelos_ENABLE_Tpetra=ON \
-DTrilinos_ENABLE_Ifpack2=ON \
-DTrilinos_ENABLE_MueLu=ON \
-DTrilinos_ENABLE_Tpetra=ON \
-DTrilinos_ENABLE_Zoltan=ON \
$SRCDIR && \
make -j$(nproc) all && \
make install
